P8105 Homework 2 \[td2704\]
================

## Problem 1

Mr. Trash Wheel sheet.

``` r
# order below
## specify sheet, omit non-data entries
## clean variable names to standardize
## omit rows without dumpster-specific data (remove na's in dumpster column)
## round number of sports balls to nearest integer

trashwheel_df = 
  read_excel("data/Trash-Wheel-Collection-Totals-7-2020-2.xlsx",
                           sheet = "Mr. Trash Wheel",
                           range = "A2:N408") %>%
  janitor::clean_names() %>%
  drop_na(dumpster) %>%
  mutate(
    sports_balls = round(sports_balls, digits = 0)
  )

trashwheel_df
```

    ## # A tibble: 345 × 14
    ##    dumpster month  year date                weight_tons volume_cubic_yards
    ##       <dbl> <chr> <dbl> <dttm>                    <dbl>              <dbl>
    ##  1        1 May    2014 2014-05-16 00:00:00        4.31                 18
    ##  2        2 May    2014 2014-05-16 00:00:00        2.74                 13
    ##  3        3 May    2014 2014-05-16 00:00:00        3.45                 15
    ##  4        4 May    2014 2014-05-17 00:00:00        3.1                  15
    ##  5        5 May    2014 2014-05-17 00:00:00        4.06                 18
    ##  6        6 May    2014 2014-05-20 00:00:00        2.71                 13
    ##  7        7 May    2014 2014-05-21 00:00:00        1.91                  8
    ##  8        8 May    2014 2014-05-28 00:00:00        3.7                  16
    ##  9        9 June   2014 2014-06-05 00:00:00        2.52                 14
    ## 10       10 June   2014 2014-06-11 00:00:00        3.76                 18
    ## # … with 335 more rows, and 8 more variables: plastic_bottles <dbl>,
    ## #   polystyrene <dbl>, cigarette_butts <dbl>, glass_bottles <dbl>,
    ## #   grocery_bags <dbl>, chip_bags <dbl>, sports_balls <dbl>,
    ## #   homes_powered <dbl>

Precipitation data for 2018 annd 2019.

``` r
precip18_df = 
  read_excel("data/Trash-Wheel-Collection-Totals-7-2020-2.xlsx",
             sheet = "2018 Precipitation",
             range = "A2:B14") %>%
  janitor::clean_names() %>%
  mutate(
    year = rep(2018, times = 12)
  ) %>%
  relocate(year)

precip18_df
```

    ## # A tibble: 12 × 3
    ##     year month total
    ##    <dbl> <dbl> <dbl>
    ##  1  2018     1  0.94
    ##  2  2018     2  4.8 
    ##  3  2018     3  2.69
    ##  4  2018     4  4.69
    ##  5  2018     5  9.27
    ##  6  2018     6  4.77
    ##  7  2018     7 10.2 
    ##  8  2018     8  6.45
    ##  9  2018     9 10.5 
    ## 10  2018    10  2.12
    ## 11  2018    11  7.82
    ## 12  2018    12  6.11

``` r
precip19_df = 
  read_excel("data/Trash-Wheel-Collection-Totals-7-2020-2.xlsx",
             sheet = "2019 Precipitation",
             range = "A2:B14") %>%
  janitor::clean_names() %>%
  mutate(
    year = rep(2019, times = 12)
  ) %>%
  relocate(year)

precip19_df
```

    ## # A tibble: 12 × 3
    ##     year month total
    ##    <dbl> <dbl> <dbl>
    ##  1  2019     1  3.1 
    ##  2  2019     2  3.64
    ##  3  2019     3  4.47
    ##  4  2019     4  1.46
    ##  5  2019     5  3.58
    ##  6  2019     6  0.42
    ##  7  2019     7  3.85
    ##  8  2019     8  2.39
    ##  9  2019     9  0.16
    ## 10  2019    10  5.45
    ## 11  2019    11  1.86
    ## 12  2019    12  3.57

``` r
precip_combined_df = 
  bind_rows(precip18_df,precip19_df) %>%
  mutate(
    month = month.name[month]
  )

precip_combined_df
```

    ## # A tibble: 24 × 3
    ##     year month     total
    ##    <dbl> <chr>     <dbl>
    ##  1  2018 January    0.94
    ##  2  2018 February   4.8 
    ##  3  2018 March      2.69
    ##  4  2018 April      4.69
    ##  5  2018 May        9.27
    ##  6  2018 June       4.77
    ##  7  2018 July      10.2 
    ##  8  2018 August     6.45
    ##  9  2018 September 10.5 
    ## 10  2018 October    2.12
    ## # … with 14 more rows

The Mr. Trash Wheel dataset has 345 rows of 14 variables: dumpster,
month, year, date, weight\_tons, volume\_cubic\_yards, plastic\_bottles,
polystyrene, cigarette\_butts, glass\_bottles, grocery\_bags,
chip\_bags, sports\_balls, homes\_powered. It tracks homes powered by
various recycled/reused items over the years 2014, 2015, 2016, 2017,
2018, 2019. The median number of sports balls in a dumpster in 2019 was
9. The resulting precipitation dataset has 24 rows of 3 variables: year,
month, total. Years included in this dataset are 2018, 2019, and the
amount of precipitation is listed for each month, year pair. From this
data, the total precipitation in 2018 was 70.33.

## Problem 2

Assume any nonzero values count as TRUE for president column

``` r
pols_month_df2 = 
  read_csv("data/fivethirtyeight_datasets/pols-month.csv") %>%
  janitor::clean_names() %>%
  filter(
    prez_gop == 2
  )
```

    ## Rows: 822 Columns: 9

    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl  (8): prez_gop, gov_gop, sen_gop, rep_gop, prez_dem, gov_dem, sen_dem, r...
    ## date (1): mon

    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
pols_month_df2
```

    ## # A tibble: 5 × 9
    ##   mon        prez_gop gov_gop sen_gop rep_gop prez_dem gov_dem sen_dem rep_dem
    ##   <date>        <dbl>   <dbl>   <dbl>   <dbl>    <dbl>   <dbl>   <dbl>   <dbl>
    ## 1 1974-08-15        2      18      45     195        0      34      59     249
    ## 2 1974-09-15        2      18      45     195        0      34      59     249
    ## 3 1974-10-15        2      18      45     195        0      34      59     249
    ## 4 1974-11-15        2      18      45     195        0      34      59     249
    ## 5 1974-12-15        2      18      45     195        0      34      59     249

``` r
pols_month_df = 
  read_csv("data/fivethirtyeight_datasets/pols-month.csv") %>%
  janitor::clean_names() %>%
  separate(mon, into = c("year", "month", "day"), sep = "-", convert = TRUE) %>%
  mutate(
    month = month.name[month]
  ) %>%
  pivot_longer(
    cols = starts_with("prez_"),
    names_to="president",
    names_prefix = "prez_",
    values_to="president_boolean"
  ) %>%
  filter(president_boolean!=0) %>%
  select(-president_boolean, -day)
```

    ## Rows: 822 Columns: 9

    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl  (8): prez_gop, gov_gop, sen_gop, rep_gop, prez_dem, gov_dem, sen_dem, r...
    ## date (1): mon

    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
pols_month_df
```

    ## # A tibble: 822 × 9
    ##     year month     gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president
    ##    <int> <chr>       <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>    
    ##  1  1947 January        23      51     253      23      45     198 dem      
    ##  2  1947 February       23      51     253      23      45     198 dem      
    ##  3  1947 March          23      51     253      23      45     198 dem      
    ##  4  1947 April          23      51     253      23      45     198 dem      
    ##  5  1947 May            23      51     253      23      45     198 dem      
    ##  6  1947 June           23      51     253      23      45     198 dem      
    ##  7  1947 July           23      51     253      23      45     198 dem      
    ##  8  1947 August         23      51     253      23      45     198 dem      
    ##  9  1947 September      23      51     253      23      45     198 dem      
    ## 10  1947 October        23      51     253      23      45     198 dem      
    ## # … with 812 more rows

``` r
snp_df = 
  read_csv("data/fivethirtyeight_datasets/snp.csv") %>%
  janitor::clean_names() %>%
  separate(date, into = c("month", "day", "year"), sep = "/", convert = TRUE) %>%
  relocate(year,month) %>%
  mutate(
    year = ifelse(year >= 1950 %% 100, 1900+year, 2000+year), # to get proper 4 digit year
  ) %>%
  select(-day) %>%
  arrange(year,month) %>%
  mutate(
    month = month.name[month]
  )
```

    ## Rows: 787 Columns: 2

    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): date
    ## dbl (1): close

    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
# snp_df = 
#   read_csv("data/fivethirtyeight_datasets/snp.csv") %>%
#   janitor::clean_names() %>%
#   mutate(
#     date = as.Date(date, "%m/%d/%y")
#   ) %>%
#   separate(date, into = c("year", "month", "day"), sep = "-", convert = TRUE) %>%
#   select(-day) %>%
#   arrange(year, month) %>%
#   mutate(
#     month = month.name[month]
#   )

snp_df
```

    ## # A tibble: 787 × 3
    ##     year month     close
    ##    <dbl> <chr>     <dbl>
    ##  1  1950 January    17.0
    ##  2  1950 February   17.2
    ##  3  1950 March      17.3
    ##  4  1950 April      18.0
    ##  5  1950 May        18.8
    ##  6  1950 June       17.7
    ##  7  1950 July       17.8
    ##  8  1950 August     18.4
    ##  9  1950 September  19.5
    ## 10  1950 October    19.5
    ## # … with 777 more rows

``` r
unemployment_df = 
  read_csv("data/fivethirtyeight_datasets/unemployment.csv") %>%
  janitor::clean_names() %>%
  pivot_longer(
    jan:dec,
    names_to="month",
    values_to="perc_unemployment"
  ) %>%
  mutate(
    year = as.integer(year),
    month = month.name[(match(month, tolower(month.abb)))]
  )
```

    ## Rows: 68 Columns: 13

    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (13): Year, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec

    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
unemployment_df
```

    ## # A tibble: 816 × 3
    ##     year month     perc_unemployment
    ##    <int> <chr>                 <dbl>
    ##  1  1948 January                 3.4
    ##  2  1948 February                3.8
    ##  3  1948 March                   4  
    ##  4  1948 April                   3.9
    ##  5  1948 May                     3.5
    ##  6  1948 June                    3.6
    ##  7  1948 July                    3.6
    ##  8  1948 August                  3.9
    ##  9  1948 September               3.8
    ## 10  1948 October                 3.7
    ## # … with 806 more rows

Merge snp into pols first. Then merge unemployment into result.

Inner join:

``` r
joined_df = 
  inner_join(pols_month_df, snp_df, by = c("year","month")) %>%
  inner_join(unemployment_df, by = c("year","month"))

joined_df
```

    ## # A tibble: 786 × 11
    ##     year month   gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president close
    ##    <dbl> <chr>     <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>     <dbl>
    ##  1  1950 January      18      44     177      29      57     269 dem        17.0
    ##  2  1950 Februa…      18      44     177      29      57     269 dem        17.2
    ##  3  1950 March        18      44     177      29      57     269 dem        17.3
    ##  4  1950 April        18      44     177      29      57     269 dem        18.0
    ##  5  1950 May          18      44     177      29      57     269 dem        18.8
    ##  6  1950 June         18      44     177      29      57     269 dem        17.7
    ##  7  1950 July         18      44     177      29      57     269 dem        17.8
    ##  8  1950 August       18      44     177      29      57     269 dem        18.4
    ##  9  1950 Septem…      18      44     177      29      57     269 dem        19.5
    ## 10  1950 October      18      44     177      29      57     269 dem        19.5
    ## # … with 776 more rows, and 1 more variable: perc_unemployment <dbl>

The first dataset pols\_month\_df contains the number of national
politicians who are Democratic or Republican at any given time,
including president, governors, senators, etc - it has 822 rows with
variables year, month, gov\_gop, sen\_gop, rep\_gop, gov\_dem, sen\_dem,
rep\_dem, president. This dataset comes from the years 1947 to 2015. The
second dataset snp\_df contains the S&P stock market index over year,
month pairs - it has 787 rows with variables year, month, close. This
dataset comes from the years 1950 to 2015. The final dataset
unemployment\_df contains the unemployment percentage in the US over
year, month pairs - it has 816 rows with variables year, month,
perc\_unemployment. This dataset comes from the years 1948 to 2015. The
resulting dataset joined\_df combines all this data into one dataframe
of size 786 rows and 11 columns with variables year, month, gov\_gop,
sen\_gop, rep\_gop, gov\_dem, sen\_dem, rep\_dem, president, close,
perc\_unemployment. It includes, by month,year pair, the number of
Democratic and Republican politicians across the US, as well as the S&P
stock index and unemployment rate at that time as well to provide
pointers for the economy at that time. This joined dataset spans the
years 1950 to 2015. This joined dataset has only year,month pairs data
that exists in all 3 of the individual datasets.

If we use left join instead:

Left join:

``` r
joined_df_left = 
  left_join(pols_month_df, snp_df, by = c("year","month")) %>%
  left_join(unemployment_df, by = c("year","month"))

joined_df_left
```

    ## # A tibble: 822 × 11
    ##     year month   gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president close
    ##    <dbl> <chr>     <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>     <dbl>
    ##  1  1947 January      23      51     253      23      45     198 dem          NA
    ##  2  1947 Februa…      23      51     253      23      45     198 dem          NA
    ##  3  1947 March        23      51     253      23      45     198 dem          NA
    ##  4  1947 April        23      51     253      23      45     198 dem          NA
    ##  5  1947 May          23      51     253      23      45     198 dem          NA
    ##  6  1947 June         23      51     253      23      45     198 dem          NA
    ##  7  1947 July         23      51     253      23      45     198 dem          NA
    ##  8  1947 August       23      51     253      23      45     198 dem          NA
    ##  9  1947 Septem…      23      51     253      23      45     198 dem          NA
    ## 10  1947 October      23      51     253      23      45     198 dem          NA
    ## # … with 812 more rows, and 1 more variable: perc_unemployment <dbl>

The first dataset pols\_month\_df contains the number of national
politicians who are Democratic or Republican at any given time,
including president, governors, senators, etc - it has 822 rows with
variables year, month, gov\_gop, sen\_gop, rep\_gop, gov\_dem, sen\_dem,
rep\_dem, president. This dataset comes from the years 1947 to 2015. The
second dataset snp\_df contains the S&P stock market index over year,
month pairs - it has 787 rows with variables year, month, close. This
dataset comes from the years 1950 to 2015. The final dataset
unemployment\_df contains the unemployment percentage in the US over
year, month pairs - it has 816 rows with variables year, month,
perc\_unemployment. This dataset comes from the years 1948 to 2015. The
resulting dataset left\_joined\_df combines all this data into one
dataframe of size 822 rows and 11 columns with variables year, month,
gov\_gop, sen\_gop, rep\_gop, gov\_dem, sen\_dem, rep\_dem, president,
close, perc\_unemployment. It includes, by month,year pair, the number
of Democratic and Republican politicians across the US, as well as the
S&P stock index and unemployment rate at that time as well to provide
pointers for the economy at that time. This joined dataset spans the
years 1947 to 2015. This left joined dataset has all year,month pairs
data that exist in pols\_month\_df, where some values for close and
unemployment may be N/A if those year,month pairs didn’t exist in the
other datasets. Hence, this is a larger dataset than the inner joined
dataframe but may be more incomplete.

## Problem 3

``` r
babynames_df = 
  read_csv("data/Popular_Baby_Names.csv") %>%
  janitor::clean_names() %>%
  distinct(.keep_all=TRUE) %>%
  mutate(
    ethnicity = replace(ethnicity, ethnicity == "bl", "00m")
  )
```

    ## Rows: 19418 Columns: 6

    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (3): Gender, Ethnicity, Child's First Name
    ## dbl (3): Year of Birth, Count, Rank

    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
unique(pull(babynames_df,ethnicity))
```

    ## [1] "ASIAN AND PACIFIC ISLANDER" "BLACK NON HISPANIC"        
    ## [3] "HISPANIC"                   "WHITE NON HISPANIC"        
    ## [5] "ASIAN AND PACI"             "BLACK NON HISP"            
    ## [7] "WHITE NON HISP"

``` r
unique(pull(babynames_df,gender))
```

    ## [1] "FEMALE" "MALE"

``` r
filter(babynames_df,childs_first_name=="olivia")
```

    ## # A tibble: 0 × 6
    ## # … with 6 variables: year_of_birth <dbl>, gender <chr>, ethnicity <chr>,
    ## #   childs_first_name <chr>, count <dbl>, rank <dbl>
